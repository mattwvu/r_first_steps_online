setwd("C:/Users/Matt/Documents/GitHub/r_first_steps_online_fall23")
setwd("C:/Users/Matt/Documents/GitHub/libguides_analytics")
setwd("C:/Users/Matt/Documents/Rprojects/libguides_analytics")
library(tidyverse)
library(gt)
library(gtExtras)
library(lubridate)
library(psych)
library(forcats)
library(tidytext)
library(SnowballC)
traffic <- read_csv("traffic_20220411-20230410.csv")
traffic <- traffic %>%
mutate(Percent_new_users = (New_users/Users) * 100) %>%
relocate(Percent_new_users, .before = Sessions) %>%
mutate(Users_sessions = Sessions/Users) %>%
relocate(Users_sessions, .after = Sessions)
traffic$Bounce_rate <- as.numeric(sub("%", "" ,traffic$Bounce_rate))
traffic$Medium <- as.factor(traffic$Medium)
traffic_ds <- traffic %>%
select(-Source, -Medium) %>%
summarise(across(everything(), list(total=sum, mean=mean)))
traffic_ds$Avg_session_duration_mean <- round(traffic_ds$Avg_session_duration_mean, digits = 1)
traffic
traffic_medium_ds <- traffic %>%
select(-Source) %>%
filter(Medium == "organic" | Medium == "direct" | Medium == "referral") %>%
group_by(Medium) %>%
summarise(across(everything(), list(total=sum, mean=mean)))
traffic_medium_ds$Avg_session_duration_mean <- round(traffic_medium_ds$Avg_session_duration_mean, digits = 1)
traffic_medium_n <- traffic %>%
filter(Medium == "organic" | Medium == "direct" | Medium == "referral") %>%
group_by(Medium) %>%
summarise(n = n())
referral_ds <- traffic_medium_n %>%
left_join(traffic_medium_ds, by = "Medium") %>%
arrange(desc(New_users_total))
traffic_medium_gt <- referral_ds %>%
select(-Percent_new_users_total,
-Users_mean,
-New_users_mean,
-Sessions_mean,
-Users_sessions_total,
-Bounce_rate_total,
-Pages_session_total,
-Avg_session_duration_total) %>%
arrange(referral_ds, desc(Users_total)) %>%
gt(rowname_col = "Medium") %>%
#set ESPN theme
gt_theme_espn() %>%
fmt_number(decimals = 1,
columns = c(Percent_new_users_mean,
Users_sessions_mean,
Bounce_rate_mean,
Pages_session_mean,
Avg_session_duration_mean),
use_seps = FALSE,
drop_trailing_dec_mark = FALSE) %>%
fmt_percent(columns = c(Percent_new_users_mean,
Bounce_rate_mean), scale_values = FALSE, decimals = 1) %>%
fmt_duration(output_units = c("minutes", "seconds"), columns = Avg_session_duration_mean) %>%
#columns labels, widths, and alignments
cols_label(
n = "Instances",
Users_total = "Views",
New_users_total = "Views",
Percent_new_users_mean = "Percent",
Sessions_total = "Total",
Users_sessions_mean = "per User",
Bounce_rate_mean = "Bounce Rate",
Pages_session_mean = " Pages Viewed",
Avg_session_duration_mean = "Duration"
) %>%
cols_align(align = "left") %>%
#format table (add spanners, title, footnotes, font size, etc...)
tab_options(table.font.size = 12, table.width = pct(100)) %>%
tab_spanner(label = "New Users", columns = New_users_total:Percent_new_users_mean) %>%
tab_spanner(label = "Sessions", columns = Sessions_total:Avg_session_duration_mean) %>%
tab_header(
title = md("**Library Guides Access** | at West Virginia University"),
subtitle = md("This table contains information on how users access guides and pages in the Springshare LibGuide System at WVU collected from April 2022 to April 2023 in Google Analytics")
)
traffic_medium_gt
traffic_referralTop <- traffic %>%
filter(Medium == "referral" & Users >= 50)
traffic_referralGT <- traffic_referralTop %>%
select(-Medium) %>%
arrange(desc(Users)) %>%
gt(rowname_col = "Source") %>%
gt_theme_espn() %>%
fmt_percent(columns = c(Percent_new_users, Bounce_rate), scale_values = FALSE, decimals = 1) %>%
fmt_number(columns = Users_sessions, decimals = 2) %>%
fmt_duration(columns = Avg_session_duration, output_units = c("minutes", "seconds")) %>%
cols_label(
Users = "Total",
New_users = "New",
Percent_new_users = "Percent New",
Sessions = "Total",
Users_sessions = "Per User",
Bounce_rate = "Bounce Rate",
Pages_session = "Pages",
Avg_session_duration = "Duration"
) %>%
cols_align(align = "left") %>%
cols_width(
Source ~ pct(32.5), c(Users:Avg_session_duration) ~ pct(7.5)
) %>%
tab_options(table.width = pct(100), table.font.size = 12) %>%
tab_spanner(
label = "Referral Users",
columns = Users:Percent_new_users
) %>%
tab_spanner(
label = "Referral Sessions",
columns = Sessions:Avg_session_duration
) %>%
tab_header(
title = md("**Usage by Referral Website** | at West Virginia University"),
subtitle = md("This table contains information on websites referring users to the Springshare LibGuide System at WVU collected from April 2022 to April 2023 collected from Google Analytics")
)
traffic_referralGT
traffic_dsGT <- traffic_ds %>%
select(Users_total, New_users_total, Percent_new_users_mean, Sessions_total, Users_sessions_mean, Bounce_rate_mean, Pages_session_mean, Avg_session_duration_mean) %>%
gt() %>%
#set theme as ESPN
gt_theme_espn() %>%
#format columns
fmt_number(decimals = 1,
columns = c(Percent_new_users_mean,
Users_sessions_mean,
Bounce_rate_mean,
Pages_session_mean,
Avg_session_duration_mean),
use_seps = FALSE,
drop_trailing_dec_mark = FALSE) %>%
fmt_percent(columns = c(Percent_new_users_mean,
Bounce_rate_mean), scale_values = FALSE, decimals = 1) %>%
fmt_duration(output_units = c("minutes", "seconds"), columns = Avg_session_duration_mean) %>%
#columns names, widths, and alignments
cols_label(
Users_total = "Views",
New_users_total = "Views",
Percent_new_users_mean = "Percent",
Sessions_total = "Total",
Users_sessions_mean = "per User",
Bounce_rate_mean = "Bounce Rate",
Pages_session_mean = " Pages Viewed",
Avg_session_duration_mean = "Duration"
) %>%
cols_width(
c(Users_total, New_users_total, Percent_new_users_mean, Sessions_total, Users_sessions_mean, Bounce_rate_mean, Pages_session_mean, Avg_session_duration_mean) ~ px(100)
) %>%
cols_align(align = "left") %>%
#format table (add spanners, title, footnotes, font size, etc...)
tab_options(table.font.size = 12, table.width = pct(100)) %>%
tab_spanner(label = "New Users", columns = New_users_total:Percent_new_users_mean) %>%
tab_spanner(label = "Sessions", columns = Sessions_total:Avg_session_duration_mean) %>%
tab_header(
title = md("**Springshare Website Pages and Guides Usage** | at West Virginia University"),
subtitle = md("This table contains information on users accessing and using guides and pages in the Springshare LibGuide System at WVU collected from April 2022 to April 2023 in Google Analytics")
)
traffic_dsGT
# Use per day data frame
usage_df <- read_csv("use_perday.csv")
usage_df
usage_df <- usage_df %>%
mutate(Day_Index = mdy(Day_Index))
colors <- c("Users" = "gold", "Views" = "navy")
usage.line <- ggplot(usage_df, aes(x = Day_Index))
usage.line +
geom_smooth(aes(y = Total_Users, color = "Users")) +
geom_smooth(aes(y = Pageviews, color = "Views")) +
theme_minimal()  +
labs (
title = "Springshare Website Pages and Guides Usage",
x = NULL,
y = NULL,
color = "Legend"
) +
theme(title = element_text(size = 16)) +
scale_color_manual(values = colors)
#load and clean data
guides_infoSS <- read_csv("guides_info.csv")
guides_dataSS <- read_csv("guides_data.csv")
guides_infoSS$Guide_ID = as.character(guides_infoSS$Guide_ID)
guides_dataSS$Guide_ID = as.character(guides_dataSS$Guide_ID)
guidesSS <- guides_dataSS %>% left_join(guides_infoSS, by = "Guide_ID")
# clean dates and remove Name
guidesSS <- guidesSS %>%
mutate(Created = mdy(Created)) %>%
mutate(Updated = mdy(Updated)) %>%
select(-Name, -Owner, -Created, -Updated, -URL, -Guide_ID)
setwd("C:/Users/Matt/Documents/GitHub/r_first_steps_online_fall23")
mean(c(1, 3, 500))
length("Hello")
length(500)
length(c(500, 400, 30)
length(c(500, 400, 30))
library(tidyverse)
fight_songs <- read_csv("fight-songs.csv")
sd(fight_songs$number_fights)
max(fight_songs$number_fights)
